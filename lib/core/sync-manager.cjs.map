{"version":3,"file":"sync-manager.cjs","sources":["../../src/core/sync-manager.ts"],"sourcesContent":[null],"names":["SyncManager","constructor","manager","options","Object","defineProperty","value","EventEmitter","sourceId","generateSourceId","enabled","initialize","Date","now","Math","random","toString","substr","supportsBroadcastChannel","initBroadcastChannel","supportsStorageEvent","initStorageEvent","setupLocalListeners","BroadcastChannel","window","channelName","channel","onmessage","event","handleSyncMessage","data","storageHandler","e","key","startsWith","message","JSON","parse","newValue","error","console","warn","addEventListener","events","forEach","on","shouldSync","engine","broadcastMessage","type","timestamp","source","engines","includes","debounce","syncTimer","clearTimeout","setTimeout","sendMessage","postMessage","localStorage","setItem","stringify","removeItem","emitter","emit","undefined","set","remove","clear","handleSyncRequest","keys","get","requestSync","ping","listener","off","destroy","close","removeEventListener","removeAllListeners"],"mappings":"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"}