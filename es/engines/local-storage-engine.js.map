{"version":3,"file":"local-storage-engine.js","sources":["../../src/engines/local-storage-engine.ts"],"sourcesContent":[null],"names":["LocalStorageEngine","BaseStorageEngine","constructor","config","Object","defineProperty","maxSize","keyPrefix","available","updateUsedSize","catch","console","error","window","localStorage","testKey","setItem","removeItem","getFullKey","key","extractKey","fullKey","startsWith","slice","length","value","ttl","Error","data","createTTLData","dataSize","calculateSize","checkStorageSpace","cleanup","DOMException","name","getItem","expired","parseTTLData","warn","clear","keys","_usedSize","i","push","getRemainingSpace","Math","max","getUsageRatio"],"mappings":"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"}